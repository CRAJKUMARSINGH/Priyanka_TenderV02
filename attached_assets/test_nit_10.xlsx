# This file will be generated by the test_data_generator.py
# It creates a sample 10 works NIT Excel file with bidder data
import pandas as pd
import os

def create_test_nit_10_file():
    """Create test NIT 10 works Excel file"""
    os.makedirs("attached_assets", exist_ok=True)
    
    # Sample works information
    works_info = pd.DataFrame({
        'Work No.': list(range(1, 11)),
        'NIT Number': [f'NIT-{100+i}/2024-25' for i in range(10)],
        'Work Description': [
            'Road construction with drainage',
            'Building construction project',
            'Bridge construction work',
            'Water supply pipeline',
            'Sewerage treatment plant',
            'Multi-story building',
            'Highway development',
            'Park landscaping project',
            'School building construction',
            'Hospital infrastructure'
        ],
        'Estimated Cost': [1500000, 2500000, 5000000, 800000, 3500000, 4200000, 7500000, 1200000, 3000000, 8500000],
        'EMD Amount': [37500, 62500, 125000, 20000, 87500, 105000, 187500, 30000, 75000, 212500],
        'Completion Period': ['8 months', '12 months', '18 months', '6 months', '15 months', '14 months', '24 months', '4 months', '10 months', '20 months']
    })
    
    # Sample bidders data for all works
    bidders_data = []
    company_names = [
        'ABC Construction Pvt. Ltd.',
        'XYZ Builders & Contractors', 
        'Supreme Engineering Works',
        'Modern Infrastructure Ltd.',
        'Progressive Construction Co.',
        'Elite Builders Pvt. Ltd.',
        'Reliable Construction Group',
        'Advanced Engineering Solutions'
    ]
    
    for work_no in range(1, 11):
        estimated_cost = works_info.loc[works_info['Work No.'] == work_no, 'Estimated Cost'].iloc[0]
        num_bidders = 4 + (work_no % 3)  # 4-6 bidders per work
        
        for i in range(num_bidders):
            variation = 0.95 + (i * 0.02) + ((work_no % 3) * 0.01)  # Slight variations
            quoted_amount = int(estimated_cost * variation)
            
            bidder_data = {
                'Work No.': work_no,
                'Bidder No.': i + 1,
                'Name of Bidder': company_names[i % len(company_names)],
                'Quoted Amount': quoted_amount,
                'EMD Status': 'Submitted' if i < num_bidders - 1 else 'Pending',
                'Technical Score': 85 + (i * 2),
                'Financial Score': 80 + (i * 3),
                'Overall Status': 'Qualified' if i < num_bidders - 1 else 'Under Review'
            }
            bidders_data.append(bidder_data)
    
    bidders_df = pd.DataFrame(bidders_data)
    
    # Create Excel file
    with pd.ExcelWriter('attached_assets/test_nit_10.xlsx', engine='openpyxl') as writer:
        works_info.to_excel(writer, sheet_name='Works_Info', index=False)
        bidders_df.to_excel(writer, sheet_name='All_Bidders', index=False)

if __name__ == "__main__":
    create_test_nit_10_file()
